"use strict";function validateEmail(b){var c=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
return c.test(b);}function validateName(b){var c=/^[A-Za-záàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ' ]+$/;return c.test(b);}function getHashUserRef(n){var i=getAbrUserCrypt();
if(n){var f="TPUserRef";var b=getCookie(f);if(b){n(b);}else{var l=new Date();l.setTime(l.getTime()+(5*60*1000));var c="expires="+l.toUTCString();var h=new XMLHttpRequest();
h.onreadystatechange=function(){if(h.readyState==4&&h.status==200){var o=JSON.parse(h.responseText);var d=o.message;document.cookie=f+"="+o.message+";"+c+";domain=.abril.com.br;path=/";
n(d);}};var g=new Date();var j=g.getTime();var m="&env=production";var e=encodeURI("https://authp.abril.com.br/setUserRef.php?"+m+"&nocache="+j);var k=encodeURI("abrilUserCryptHash="+i);
h.open("POST",e,true);h.setRequestHeader("Content-type","application/x-www-form-urlencoded");h.send(k);}}}function syncPianoAssine(q){var k=getAbrUserCrypt();
if(q){var g="CheckSyncPiano";var b=getCookie(g);if(b){q();}else{var o=new Date();o.setTime(o.getTime()+(1*24*60*60*1000));var e="expires="+o.toUTCString();
var i=new Date();i.setTime(i.getTime()+(30*24*60*60*1000));var c="expires="+i.toUTCString();var j=new XMLHttpRequest();j.onreadystatechange=function(){if(j.readyState==4&&j.status==200){var m=JSON.parse(j.responseText);
if(typeof m.firstName!=="undefined"){var d=m.firstName.split(" ");d=d[0].toLowerCase();d=d.charAt(0).toUpperCase()+d.slice(1);document.cookie=g+"="+m.message+";"+e+";domain=.abril.com.br;path=/";
document.cookie="userIdMetricGA="+m.fullName+";"+e+";domain=.abril.com.br;path=/";document.cookie="userAbrilLogged="+d+";"+c+";domain=.abril.com.br;path=/";
}q();}};var h=new Date();var l=h.getTime();var p="&env=production";var f=encodeURI("https://authp.abril.com.br/syncPianoAssine.php?"+p+"&nocache="+l);var n=encodeURI("abrilUserCryptHash="+k);
j.open("POST",f,true);j.setRequestHeader("Content-type","application/x-www-form-urlencoded");j.send(n);}}}function setUserHashAnalytics(){var c="userHashAnalytics";
var e=getCookie(c);if(!e){var g=new Date();g.setTime(g.getTime()+(1*24*60*60*1000));var b="expires="+g.toUTCString();var f=$.ajax({url:"https://authp.abril.com.br/setUserHashAnalytics.php",method:"POST",async:true,complete:function(d){document.cookie=c+"="+d.responseText+";"+b+";domain=.abril.com.br;path=/";
},data:{env:"production",abrilUserCryptHash:getAbrUserCrypt()}});}}function getCookie(g,k){var f=g+"=";var d=document.cookie.split(";");for(var h=0;h<d.length;
h++){var l=d[h];while(l.charAt(0)==" "){l=l.substring(1);}if(l.indexOf(f)==0&&k==undefined){return l.substring(f.length,l.length);}if(l.indexOf(f)==0&&k){var b=[];
str=l.substring(f.length,l.length);str=str.split(":");for(var e=0;e<str.length;e++){a=str[e].split("=");b[a[0]]=a[1];}if(b[k]){return b[k];}}}return"";
}function setCookie(e,f,c){var b="";if(c){var g=c;b="expires="+g.toUTCString();}document.cookie=e+"="+f+";"+b+";domain=.abril.com.br;path=/";}function deleteCookie(b){var c=new Date();
c.setTime(c.getTime()-1);setCookie(b,"false",c);}function logoutPaywall(){document.cookie="AbrilUser=; expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=.abril.com.br;path=/";
document.cookie="TPUserRef=; expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=.abril.com.br;path=/";document.cookie="CheckSyncPiano=; expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=.abril.com.br;path=/";
document.cookie="userAbrilLogged=; expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=.abril.com.br;path=/";location.reload();}function getAbrUserCrypt(){return getCookie("AbrilUser");
}function printScriptTP(b,c){var d=$("<div></div>");d.attr("id","piano_offer").css("width","100%").hide().appendTo("BODY");(function(g){var f=document.createElement("script");
f.type="text/javascript";f.async=true;f.src=g;var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(f,e);})("//"+b+".tinypass.com/xbuilder/experience/load?aid="+c);
}var thisOffer=false;function setOfferParams(b){thisOffer={templateId:b.templateId,offerId:b.offerId};}function showOffer(){if(tp&&thisOffer){tp.offer.show(thisOffer);
}}if(typeof ga==="undefined"){(function(d,e,j,h,f,c,b){d.GoogleAnalyticsObject=f;d[f]=d[f]||function(){(d[f].q=d[f].q||[]).push(arguments);},d[f].l=1*new Date();
c=e.createElement(j),b=e.getElementsByTagName(j)[0];c.async=1;c.src=h;b.parentNode.insertBefore(c,b);})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");
}if(typeof label_piano_analytics==="undefined"){var label_piano_analytics="";}if(typeof id_piano_analytics==="undefined"){var id_piano_analytics="";}if(typeof piano_brand==="undefined"){var piano_brand="";
}ga("create",id_piano_analytics,{name:"ga"+piano_brand,cookieName:"_ga"+piano_brand,cookieDomain:"abril.com.br",});function setCookieSignwall(c){var d=new Date();
d.setTime(d.getTime()+(12*24*60*60*1000));var b="expires="+d.toUTCString();document.cookie="_pc_"+c+"_signwall=true;"+b+";domain=.abril.com.br;path=/";
location.reload();}var eventLabel=label_piano_analytics;window.addEventListener("message",function(i){if(i.data.action==="LoginSuccess"||i.data.action==="LoginFacebookSuccess"||i.data.action==="CheckoutPagamentoSuccess"){if(i.data.asi_piano){var l="";
l=new Date();l.setTime(l.getTime()+(30*24*60*60*1000));setCookie("AbrilUser",i.data.asi_piano,l);}}switch(i.data.action){case"setEventLabel":if(typeof i.data.eventLabel!="undefined"&&i.data.eventLabel!=""){eventLabel=i.data.eventLabel+" - "+eventLabel;
}break;case"createCookie":var l="";l=new Date();l.setTime(l.getTime()+(9*60*1000));var c=l;l.setTime(l.getTime()+(30*24*60*60*1000));var n=l;setCookie("TPUserRef",i.data.userRef,c);
setCookie("AbrilUser",i.data.crypt,n);setUserHashAnalytics();tp.offer.close();break;case"showOffer":if(typeof i.data.eventLabel!="undefined"&&i.data.eventLabel!=""){eventLabel=i.data.eventLabel;
}$("DIV, SECTION, FOOTER").hide();$("#piano_offer").show();$("#piano_offer DIV").show();$("BODY").css("padding","0px");ga("set","metric1",1);ga("ga"+piano_brand+".send",{hitType:"event",eventCategory:"Paywall",eventAction:"Bloqueio de Leitura",eventLabel:eventLabel});
break;case"forceOffer":var b=window.location.href+"?oferta=true";window.location.href=b;break;case"forceLogin":var b=window.location.href+"?login=true";
window.location.href=b;break;case"logoutPaywall":logoutPaywall();break;case"close":tp.offer.close();break;case"LoginFacebookSuccess":case"LoginSuccess":ga("set","metric2",1);
ga("ga"+piano_brand+".send",{hitType:"event",eventCategory:"Paywall",eventAction:"Login Efetuado",eventLabel:eventLabel});break;case"CheckoutLoginInit":ga("set","metric3",1);
ga("ga"+piano_brand+".send",{hitType:"event",eventCategory:"Paywall",eventAction:"Entrada no Fluxo de Compra",eventLabel:eventLabel});break;case"CheckoutTesteABClick":ga("set","metric4",1);
ga("ga"+piano_brand+".send",{hitType:"event",eventCategory:"Paywall",eventAction:"Avanço Exibição de Preço A/B",eventLabel:eventLabel});break;case"CheckoutFacebookLoginSuccess":case"CheckoutLoginSuccess":case"CheckoutPadraoLoginSuccess":ga("set","metric5",1);
ga("ga"+piano_brand+".send",{hitType:"event",eventCategory:"Paywall",eventAction:"Login Checkout Efetuado",eventLabel:eventLabel});break;case"CheckoutCadastroSuccess":case"CheckoutPadraoCadastroSuccess":ga("set","metric6",1);
ga("ga"+piano_brand+".send",{hitType:"event",eventCategory:"Paywall",eventAction:"Cadastro Efetuado",eventLabel:eventLabel});break;case"CheckoutPagamentoSuccess":case"CheckoutPadraoPagamentoSuccess":ga("set","metric7",1);
ga("ga"+piano_brand+".send",{hitType:"event",eventCategory:"Paywall",eventAction:"Pagamento Efetuado",eventLabel:eventLabel});break;case"signwallLoginOk":var h=new XMLHttpRequest();
h.onreadystatechange=function(){if(h.readyState==4){var d=JSON.parse(h.responseText);if(d.status){setCookieSignwall(i.data.brand);}}};var g=new Date();
var j=g.getTime();var m="&env=production";var f=encodeURI("https://authp.abril.com.br/createUserSignwall.php?"+m+"&nocache="+j);var k=encodeURI("abrilUserFirstName="+i.data.firstname+"&abrilUserLastName="+i.data.lastname+"&abrilUserEmail="+i.data.email+"&abrilUserTermId="+i.data.resource_id);
h.open("POST",f,true);h.setRequestHeader("Content-type","application/x-www-form-urlencoded");h.send(k);break;case"signwallAuthorizedOk":tp.api.callApi("/conversion/registration/create",{term_id:i.data.term_id},function(d){tp.user.refreshAccessToken(true,function(e){setCookieSignwall(i.data.brand);
});});break;case"createCookieSignwall":setCookieSignwall(i.data.brand);break;case"bloqueioLeituraPianoID":ga("set","metric1",1);ga("ga"+piano_brand+".send",{hitType:"event",eventCategory:"Signwall",eventAction:"Bloqueio de Leitura",eventLabel:eventLabel});
break;case"avisoLeituraPianoID":ga("set","metric2",1);ga("ga"+piano_brand+".send",{hitType:"event",eventCategory:"Signwall",eventAction:"Aviso de Leitura",eventLabel:eventLabel});
break;}if(i.data.action=="LoginInit"||i.data.action=="LoginSuccess"||i.data.action=="LoginFail"||i.data.action=="LoginFacebookSuccess"||i.data.action=="LoginFacebookFail"||i.data.action=="CheckoutLoginSuccess"||i.data.action=="CheckoutLoginFail"||i.data.action=="CheckoutFacebookLoginSuccess"||i.data.action=="CheckoutFacebookLoginFail"||i.data.action=="CheckoutCadastroSuccess"||i.data.action=="CheckoutCadastroFail"||i.data.action=="CheckoutPagamentoSuccess"||i.data.action=="CheckoutPagamentoFail"||i.data.action=="CheckoutPadraoInit"||i.data.action=="CheckoutPadraoCarrinho"||i.data.action=="CheckoutPadraoPopOffer"||i.data.action=="CheckoutPadraoLoginInit"||i.data.action=="CheckoutPadraoCadastroInit"||i.data.action=="CheckoutPadraoLoginSuccess"||i.data.action=="CheckoutPadraoLoginFail"||i.data.action=="CheckoutPadraoCadastroSuccess"||i.data.action=="CheckoutPadraoCadastroFail"||i.data.action=="CheckoutPadraoAddress"||i.data.action=="CheckoutPadraoPagamentoInit"||i.data.action=="CheckoutPadraoPopPromotion"||i.data.action=="CheckoutPadraoPagamentoSuccess"||i.data.action=="CheckoutPadraoPagamentoFail"||i.data.action=="CheckoutPadraoSiteBack"){window.scrollTo(0,0);
}},false);var views=0;var maxViews=0;function pushCustomVariablesofView(b){views=b.views;maxViews=b.maxViews;tp=window.tp||[];tp.push(["setCustomVariable","views",b.views]);
tp.push(["setCustomVariable","maxViews",b.maxViews]);}function startPiano(b,c){if(getAbrUserCrypt()){syncPianoAssine(function(){getHashUserRef(function(d){tp.push(["setUserRef",getCookie("TPUserRef")]);
printScriptTP(b,c);});});}else{printScriptTP(b,c);}}